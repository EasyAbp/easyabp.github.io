<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>Abp.EventBus.Boxes.Dtm | EasyAbp</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/assets/logo.png">
    <meta name="description" content="An open source organization to enhance your ABP project development efficiency.">
    <link rel="preload" href="/assets/css/0.styles.a3c98fcf.css" as="style"><link rel="preload" href="/assets/js/app.d08d4d6d.js" as="script"><link rel="preload" href="/assets/js/2.96af7ef6.js" as="script"><link rel="preload" href="/assets/js/34.9b2c128d.js" as="script"><link rel="prefetch" href="/assets/js/10.86cee72c.js"><link rel="prefetch" href="/assets/js/11.b81468f8.js"><link rel="prefetch" href="/assets/js/12.6407e065.js"><link rel="prefetch" href="/assets/js/13.7eee606a.js"><link rel="prefetch" href="/assets/js/14.d02acbbd.js"><link rel="prefetch" href="/assets/js/15.1e854e2a.js"><link rel="prefetch" href="/assets/js/16.60f20fe6.js"><link rel="prefetch" href="/assets/js/17.b066943b.js"><link rel="prefetch" href="/assets/js/18.07575662.js"><link rel="prefetch" href="/assets/js/19.216ac5f4.js"><link rel="prefetch" href="/assets/js/20.30621af9.js"><link rel="prefetch" href="/assets/js/21.0d6c3bfb.js"><link rel="prefetch" href="/assets/js/22.63f9dff8.js"><link rel="prefetch" href="/assets/js/23.985b71b2.js"><link rel="prefetch" href="/assets/js/24.375fe2e1.js"><link rel="prefetch" href="/assets/js/25.1c11bba6.js"><link rel="prefetch" href="/assets/js/26.1de826bd.js"><link rel="prefetch" href="/assets/js/27.5dac6e0b.js"><link rel="prefetch" href="/assets/js/28.a9ade00e.js"><link rel="prefetch" href="/assets/js/29.24502127.js"><link rel="prefetch" href="/assets/js/3.31365dc5.js"><link rel="prefetch" href="/assets/js/30.0a961a07.js"><link rel="prefetch" href="/assets/js/31.27133d69.js"><link rel="prefetch" href="/assets/js/32.d01afef6.js"><link rel="prefetch" href="/assets/js/33.0034da6c.js"><link rel="prefetch" href="/assets/js/35.1a28d6f7.js"><link rel="prefetch" href="/assets/js/36.452000a3.js"><link rel="prefetch" href="/assets/js/37.6cfd93e3.js"><link rel="prefetch" href="/assets/js/38.0c3ff3bf.js"><link rel="prefetch" href="/assets/js/39.11ddea1b.js"><link rel="prefetch" href="/assets/js/4.93589f4d.js"><link rel="prefetch" href="/assets/js/40.d4a2b8a4.js"><link rel="prefetch" href="/assets/js/41.b4af454a.js"><link rel="prefetch" href="/assets/js/42.3ddcba15.js"><link rel="prefetch" href="/assets/js/43.02ed8ddd.js"><link rel="prefetch" href="/assets/js/44.127ecef0.js"><link rel="prefetch" href="/assets/js/45.aebaf90a.js"><link rel="prefetch" href="/assets/js/46.0112773b.js"><link rel="prefetch" href="/assets/js/47.a69700fb.js"><link rel="prefetch" href="/assets/js/48.629fea67.js"><link rel="prefetch" href="/assets/js/49.3c14cdfd.js"><link rel="prefetch" href="/assets/js/5.a7d07d0f.js"><link rel="prefetch" href="/assets/js/50.ba83c2ad.js"><link rel="prefetch" href="/assets/js/51.6d15db73.js"><link rel="prefetch" href="/assets/js/52.c4c41646.js"><link rel="prefetch" href="/assets/js/53.625a7bf5.js"><link rel="prefetch" href="/assets/js/54.f74bc0cf.js"><link rel="prefetch" href="/assets/js/55.039b7af1.js"><link rel="prefetch" href="/assets/js/56.c9aeb270.js"><link rel="prefetch" href="/assets/js/57.04113905.js"><link rel="prefetch" href="/assets/js/58.ae33aa8f.js"><link rel="prefetch" href="/assets/js/59.933195ff.js"><link rel="prefetch" href="/assets/js/6.edd9dac5.js"><link rel="prefetch" href="/assets/js/60.90b0e4f7.js"><link rel="prefetch" href="/assets/js/61.9eee203a.js"><link rel="prefetch" href="/assets/js/62.34616d1f.js"><link rel="prefetch" href="/assets/js/63.3b366023.js"><link rel="prefetch" href="/assets/js/64.f213f7cb.js"><link rel="prefetch" href="/assets/js/65.cc4b17bf.js"><link rel="prefetch" href="/assets/js/66.c67cad05.js"><link rel="prefetch" href="/assets/js/67.f4790eb1.js"><link rel="prefetch" href="/assets/js/68.f80c7525.js"><link rel="prefetch" href="/assets/js/69.f157c8f9.js"><link rel="prefetch" href="/assets/js/7.1132d821.js"><link rel="prefetch" href="/assets/js/70.08295794.js"><link rel="prefetch" href="/assets/js/71.bacc5eb7.js"><link rel="prefetch" href="/assets/js/72.8fabbdaf.js"><link rel="prefetch" href="/assets/js/73.d1df5978.js"><link rel="prefetch" href="/assets/js/8.c8cea6c8.js"><link rel="prefetch" href="/assets/js/9.42399e2c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a3c98fcf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="nav-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-6 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active home-link"><img src="/assets/logo.png" alt="EasyAbp" class="logo"> <span class="site-name">EasyAbp</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="nav-space-between ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-18 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
            Home
          </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/guide/EasyAbpGuide/">
            Guide
          </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/abphelper/">
            AbpHelper
          </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/modules/" class="router-link-active">
            Modules
          </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/apps/">
            Apps
          </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="https://abp.io" target="_blank">
            ABP Framework
            <i aria-label="icon: link" class="anticon anticon-link"><svg viewBox="64 64 896 896" focusable="false" data-icon="link" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M574 665.4a8.03 8.03 0 0 0-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 0 0-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 0 0 0 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 0 0 0 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 0 0-11.3 0L372.3 598.7a8.03 8.03 0 0 0 0 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"></path></svg></i></a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <ul class="extra-group"><li><a href="https://github.com/EasyAbp" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></li> <!----></ul></nav></div></div> <!----></header> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/modules/" aria-current="page" title="Introduction" class="sidebar-link">Introduction</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Infrastructure</span> <span class="arrow down"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/modules/Abp.GraphQL/" title="Abp.GraphQL" class="sidebar-link">Abp.GraphQL</a></li><li><a href="/modules/Abp.AspNetCoreRateLimit/" title="Abp.AspNetCoreRateLimit" class="sidebar-link">Abp.AspNetCoreRateLimit</a></li><li><a href="/modules/Abp.DataDictionary/" title="Abp.DataDictionary" class="sidebar-link">Abp.DataDictionary</a></li><li><a href="/modules/Abp.RelatedDtoLoader/" title="Abp.RelatedDtoLoader" class="sidebar-link">Abp.RelatedDtoLoader</a></li><li><a href="/modules/Abp.SettingUi/" title="Abp.SettingUi" class="sidebar-link">Abp.SettingUi</a></li><li><a href="/modules/Abp.EventBus.Boxes.Dtm/" aria-current="page" title="Abp.EventBus.Boxes.Dtm" class="active sidebar-link">Abp.EventBus.Boxes.Dtm</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/modules/Abp.EventBus.Boxes.Dtm/#introduction" title="Introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/modules/Abp.EventBus.Boxes.Dtm/#differences-from-the-abp-s-default-event-boxes" title="Differences From the ABP's Default Event Boxes" class="sidebar-link">Differences From the ABP's Default Event Boxes</a></li><li class="sidebar-sub-header"><a href="/modules/Abp.EventBus.Boxes.Dtm/#how-does-the-dtm-outbox-work" title="How Does the DTM Outbox Work?" class="sidebar-link">How Does the DTM Outbox Work?</a></li><li class="sidebar-sub-header"><a href="/modules/Abp.EventBus.Boxes.Dtm/#how-does-the-dtm-inbox-work" title="How Does the DTM Inbox Work?" class="sidebar-link">How Does the DTM Inbox Work?</a></li><li class="sidebar-sub-header"><a href="/modules/Abp.EventBus.Boxes.Dtm/#installation" title="Installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/modules/Abp.EventBus.Boxes.Dtm/#usage" title="Usage" class="sidebar-link">Usage</a></li><li class="sidebar-sub-header"><a href="/modules/Abp.EventBus.Boxes.Dtm/#roadmap" title="Roadmap" class="sidebar-link">Roadmap</a></li></ul></li><li><a href="/modules/Abp.EventBus.CAP/" title="Abp.EventBus.CAP" class="sidebar-link">Abp.EventBus.CAP</a></li><li><a href="/modules/Abp.TagHelperPlus/" title="Abp.TagHelperPlus" class="sidebar-link">Abp.TagHelperPlus</a></li><li><a href="/modules/Abp.Trees/" title="Abp.Trees" class="sidebar-link">Abp.Trees</a></li><li><a href="/modules/CacheManagement/" title="CacheManagement" class="sidebar-link">CacheManagement</a></li><li><a href="/modules/LoggingManagement/" title="LoggingManagement" class="sidebar-link">LoggingManagement</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Business</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Community</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Message</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resource</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Account</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Dynamic</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>WeChat</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Theme</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Other</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li></ul> </aside> <main class="page has-page-anchor"> <div class="theme-antdocs-content content__default"><h1 id="abp-eventbus-boxes-dtm"><a href="#abp-eventbus-boxes-dtm" class="header-anchor">#</a> Abp.EventBus.Boxes.Dtm</h1> <p><a href="https://abp.io" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/dynamic/xml?style=flat-square&amp;color=yellow&amp;label=abp&amp;query=%2F%2FProject%2FPropertyGroup%2FAbpVersion&amp;url=https%3A%2F%2Fraw.githubusercontent.com%2FEasyAbp%2FAbp.EventBus.Boxes.Dtm%2Fmain%2FDirectory.Build.props" alt="ABP version"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.nuget.org/packages/EasyAbp.Abp.EventBus.Boxes.Dtm" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/nuget/v/EasyAbp.Abp.EventBus.Boxes.Dtm.svg?style=flat-square" alt="NuGet"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.nuget.org/packages/EasyAbp.Abp.EventBus.Boxes.Dtm" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/nuget/dt/EasyAbp.Abp.EventBus.Boxes.Dtm.svg?style=flat-square" alt="NuGet Download"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://discord.gg/S6QaezrCRq" target="_blank" rel="noopener noreferrer"><img src="https://badgen.net/discord/online-members/S6QaezrCRq?label=Discord" alt="Discord online"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.github.com/EasyAbp/Abp.EventBus.Boxes.Dtm" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/github/stars/EasyAbp/Abp.EventBus.Boxes.Dtm?style=social" alt="GitHub stars"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The <a href="https://github.com/dtm-labs/dtm" target="_blank" rel="noopener noreferrer">DTM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> implementation module of ABP distributed event boxes.</p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>This implementation uses DTM's <a href="https://en.dtm.pub/practice/msg.html" target="_blank" rel="noopener noreferrer">2-phase messages<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to support ABP event boxes in the <a href="https://github.com/abpframework/abp/issues/10036" target="_blank" rel="noopener noreferrer">multi-tenant &amp; multi-database scene<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>You should see the <a href="https://en.dtm.pub/guide/start.html" target="_blank" rel="noopener noreferrer">DTM docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which help to understand this module.</p> <h2 id="differences-from-the-abp-s-default-event-boxes"><a href="#differences-from-the-abp-s-default-event-boxes" class="header-anchor">#</a> Differences From the ABP's Default Event Boxes</h2> <table><thead><tr><th style="text-align:center;"></th> <th style="text-align:center;">DTM 2-phase Message Boxes</th> <th style="text-align:center;">ABP 5.0+ Default Boxes</th></tr></thead> <tbody><tr><td style="text-align:center;">Speediness</td> <td style="text-align:center;">âœ”ï¸</td> <td style="text-align:center;">âŒ</td></tr> <tr><td style="text-align:center;">Less data transfer</td> <td style="text-align:center;">âŒ</td> <td style="text-align:center;">âœ”ï¸</td></tr> <tr><td style="text-align:center;">Be guaranteed to publish<br>(transactional UOW)</td> <td style="text-align:center;">âœ”ï¸</td> <td style="text-align:center;">âœ”ï¸</td></tr> <tr><td style="text-align:center;">Be guaranteed to publish<br>(non-transactional UOW)</td> <td style="text-align:center;">âŒ</td> <td style="text-align:center;">âœ”ï¸<br>(consumers idempotency required)</td></tr> <tr><td style="text-align:center;">No consumers idempotency required</td> <td style="text-align:center;">âœ”ï¸</td> <td style="text-align:center;">âœ”ï¸</td></tr> <tr><td style="text-align:center;">Multi-tenant-database support</td> <td style="text-align:center;">âœ”ï¸</td> <td style="text-align:center;">âŒ</td></tr> <tr><td style="text-align:center;">No additional external infrastructure</td> <td style="text-align:center;">âŒ</td> <td style="text-align:center;">âœ”ï¸</td></tr> <tr><td style="text-align:center;">Dashboard and Alarm</td> <td style="text-align:center;">âœ”ï¸</td> <td style="text-align:center;">âŒ</td></tr></tbody></table> <h2 id="how-does-the-dtm-outbox-work"><a href="#how-does-the-dtm-outbox-work" class="header-anchor">#</a> How Does the DTM Outbox Work?</h2> <p>You are publishing events using the ABP event outbox:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">await</span> _distributedEventBus<span class="token punctuation">.</span><span class="token function">PublishAsync</span><span class="token punctuation">(</span>eto1<span class="token punctuation">,</span> <span class="token named-parameter punctuation">useOutbox</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> _distributedEventBus<span class="token punctuation">.</span><span class="token function">PublishAsync</span><span class="token punctuation">(</span>eto2<span class="token punctuation">,</span> <span class="token named-parameter punctuation">useOutbox</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// The useOutbox is true by default.</span>
</code></pre></div><p>The DTM outbox collects them temporarily. Let's see what it will do when you complete the current unit of work:</p> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Code snippet for UnitOfWork.cs</span>
<span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">CommitTransactionsAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Step 1: inserting a record to the DTM barrier table within the current DB transaction,</span>
    <span class="token comment">//         and then it sends a &quot;prepare&quot; request to the DTM server.</span>
    <span class="token keyword">await</span> DtmMessageManager<span class="token punctuation">.</span><span class="token function">InsertBarriersAndPrepareAsync</span><span class="token punctuation">(</span>EventBag<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Step 2: committing the current DB transaction.</span>
    <span class="token keyword">await</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">CommitTransactionsAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Step 3: sending a &quot;submit&quot; request to the DTM server.</span>
    <span class="token function">OnCompleted</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">await</span> DtmMessageManager<span class="token punctuation">.</span><span class="token function">SubmitAsync</span><span class="token punctuation">(</span>EventBag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now, the DTM server has received a &quot;submit&quot; request. It invokes the app's <code>PublishEvents</code> service with the events' data, and the latter will publish the events to the MQ provider immediately.</p> <p><a href="https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNqFk89uwjAMxl_Fypm-QA5IaOzAAW2IcevFbVyIlqRd_rAhxLsvbVooUG09NfHPX7449pmVtSDGmaOvQKakpcS9RZ0biJ-XXhEsP9bwFnxR_6RdDL42QRdk03rnyGbz-aJpOLyo2hGgAelcoBSPgRheoscCHUXmgGZPiQDn0d9z19M4LISAVYvtGhExEYX7jW2bloQE0JGMd0nkln535spEkx6wixdorRzc3yfExZbskSzvAo2lBi3dyBTMHnyOUDGh2lXmmXmqS6219OAPBN6icVh6WZter6eya6ET7EJZEokHyZG1ae7PS7tQxJT_7ryCb6kUVNJId-hMJ7_P7zCuQNKesh2ptpF4el8ou0aasN276TUX3ZmQwXso1GBk3A-pIusNnyBAak1Cxk5Sp0SvN1e3Az5tdVyz3oOoDU3YHJNrtJ-ALmk6VwXFZkyT1ShFnMFzm56zaFBTznj8FVRhUD5nublENHRj8Cqkry3jFSpHM9aO4_ZkSsa9DTRA_Rz31OUXaXxJzw" target="_blank" rel="noopener noreferrer"><img src="https://mermaid.ink/img/pako:eNqFk89uwjAMxl_Fypm-QA5IaOzAAW2IcevFbVyIlqRd_rAhxLsvbVooUG09NfHPX7449pmVtSDGmaOvQKakpcS9RZ0biJ-XXhEsP9bwFnxR_6RdDL42QRdk03rnyGbz-aJpOLyo2hGgAelcoBSPgRheoscCHUXmgGZPiQDn0d9z19M4LISAVYvtGhExEYX7jW2bloQE0JGMd0nkln535spEkx6wixdorRzc3yfExZbskSzvAo2lBi3dyBTMHnyOUDGh2lXmmXmqS6219OAPBN6icVh6WZter6eya6ET7EJZEokHyZG1ae7PS7tQxJT_7ryCb6kUVNJId-hMJ7_P7zCuQNKesh2ptpF4el8ou0aasN276TUX3ZmQwXso1GBk3A-pIusNnyBAak1Cxk5Sp0SvN1e3Az5tdVyz3oOoDU3YHJNrtJ-ALmk6VwXFZkyT1ShFnMFzm56zaFBTznj8FVRhUD5nublENHRj8Cqkry3jFSpHM9aO4_ZkSsa9DTRA_Rz31OUXaXxJzw" alt=""><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <details><summary>See the more detailed sequence diagram</summary> <p><a href="https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNqtVU1v2zAM_SuETy2Q5FwYQ4ps6TYDC7YiLXrJhbaYRKgsefpoFhT976O_YidxgK5YTpH5SD4-ktJrlBlBURw5-h1IZzSXuLGYrzTwz0uvCOYPC_gZfGr-wBietuhBrsFv2fAZvEXtMPPSaMhMnkvvpd6AdOCU2d3WYTB4o0Oekq3Pj47seDqdFUUMX5RxBKjZxQWq7Wxg8xw9puiIMVvUG6oR4Dz6Y9yBXgwzISApYY-FYJjgwM2HZelWBxJAL6S9q4N07kc5E80kPWBlT9Fa2bI_duDDkuwL2bgyFJYKtNQha-P4hGcPKgaiVsqcY850qQSvWtHrw1nuY5ZPyC5rY7k0ZbhVXuY0mUwGvCoW32k_AqYAexNgS5ZuIYEdak5rQA6I9Cm106ud9NuKl8Oc4FsyB3TVeRX1VYrAlmPnPDhuyHUzLcr3eJSjtEbnW_WHdDj0qqFQldeF6Bxbl3FbXePpQpYRiVbnNseJcpfBZ3EfemtxxeQLuLlu9gO-zpIfd_NSJsHjzCqKUCiZ8XjCRooRWKMUz2iK2XMvw6V2JiwdTeChXMucOOvpONQCSg5ZpmRhnJdKcQtMRs7xsk5ggfa5bFCZuUtLiheTqxnqwD8VfEHd_9rBD4l6uce1YB-Rv6Rw2oGhiTlbtFmNHcOvkCrp6vXpX1Sdbov7eAAFMs9JSC5Z7TuPxf1BqtblfdPe8BFG0zt0aEeoiu3cOqhmiDRniUZRTjZHKfiheS0Nq4h553wBxPxX0BqD8qtopd8YGqqr-05Ib2wUr5HHcBSVT8hyr7Mo9jZQC2oeqwb19he08zVf" target="_blank" rel="noopener noreferrer"><img src="https://mermaid.ink/img/pako:eNqtVU1v2zAM_SuETy2Q5FwYQ4ps6TYDC7YiLXrJhbaYRKgsefpoFhT976O_YidxgK5YTpH5SD4-ktJrlBlBURw5-h1IZzSXuLGYrzTwz0uvCOYPC_gZfGr-wBietuhBrsFv2fAZvEXtMPPSaMhMnkvvpd6AdOCU2d3WYTB4o0Oekq3Pj47seDqdFUUMX5RxBKjZxQWq7Wxg8xw9puiIMVvUG6oR4Dz6Y9yBXgwzISApYY-FYJjgwM2HZelWBxJAL6S9q4N07kc5E80kPWBlT9Fa2bI_duDDkuwL2bgyFJYKtNQha-P4hGcPKgaiVsqcY850qQSvWtHrw1nuY5ZPyC5rY7k0ZbhVXuY0mUwGvCoW32k_AqYAexNgS5ZuIYEdak5rQA6I9Cm106ud9NuKl8Oc4FsyB3TVeRX1VYrAlmPnPDhuyHUzLcr3eJSjtEbnW_WHdDj0qqFQldeF6Bxbl3FbXePpQpYRiVbnNseJcpfBZ3EfemtxxeQLuLlu9gO-zpIfd_NSJsHjzCqKUCiZ8XjCRooRWKMUz2iK2XMvw6V2JiwdTeChXMucOOvpONQCSg5ZpmRhnJdKcQtMRs7xsk5ggfa5bFCZuUtLiheTqxnqwD8VfEHd_9rBD4l6uce1YB-Rv6Rw2oGhiTlbtFmNHcOvkCrp6vXpX1Sdbov7eAAFMs9JSC5Z7TuPxf1BqtblfdPe8BFG0zt0aEeoiu3cOqhmiDRniUZRTjZHKfiheS0Nq4h553wBxPxX0BqD8qtopd8YGqqr-05Ib2wUr5HHcBSVT8hyr7Mo9jZQC2oeqwb19he08zVf" alt=""><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNp1VMtu2zAQ_JUFTy1g6wOEwoFbp62ABjk4QS66rMW1TUQkVXKV1Ajy711Sit_RSdTODmdnSL2pxmtSpYr0tyfX0MLgJqCtHcjDhluCxcMd3Pe88v9gCk9bZDBr4K0UvgMHdBEbNt5B4601zKRhjaYlfTOQYM_e9XZFYVg_RgrT2WzedSX8aH0kQAcmxp6GuhSkvEDGFUYSzBbdhgYEREY-xe3FlTDXGqoEe-w0Jh3oxg_L1DYQaaAXchwHkkP7yZ6VE5EMmOsrDMF8qD9tkMWSwguFMhe6QB0GOiCH4vRM5xFUX2HNzlxiLnzJducgjlIY-UbUdG_0AP45r_7cLiYQfCsByWTN84FcsCmbEu47CpgjHYK8mOd08icU5rUPYlfr3UZOjaWiKK50ZSm_aTcBGQt2voctBbqBCl7RySgezBXjv63C7Mur4W2eNaIl-FUtAGNe1-rYeQUhHeTIECXkr9ed26c7bpDFH4R-YuHYFfumIdLHqZz5cR34qX2VSKUCHtLFsiRBnkcqR38MIjkhUiObtpWRfUMxGrcp4A7DczIk5ZpCVRNlKVg0Wq72WxJQK2G1YlApr5rW2Ldcq9q9C7TP1-VWG_ZBlWtsI01UurbLnWtUyaGnD9D4exhR7_8BefBo_w" target="_blank" rel="noopener noreferrer"><img src="https://mermaid.ink/img/pako:eNp1VMtu2zAQ_JUFTy1g6wOEwoFbp62ABjk4QS66rMW1TUQkVXKV1Ajy711Sit_RSdTODmdnSL2pxmtSpYr0tyfX0MLgJqCtHcjDhluCxcMd3Pe88v9gCk9bZDBr4K0UvgMHdBEbNt5B4601zKRhjaYlfTOQYM_e9XZFYVg_RgrT2WzedSX8aH0kQAcmxp6GuhSkvEDGFUYSzBbdhgYEREY-xe3FlTDXGqoEe-w0Jh3oxg_L1DYQaaAXchwHkkP7yZ6VE5EMmOsrDMF8qD9tkMWSwguFMhe6QB0GOiCH4vRM5xFUX2HNzlxiLnzJducgjlIY-UbUdG_0AP45r_7cLiYQfCsByWTN84FcsCmbEu47CpgjHYK8mOd08icU5rUPYlfr3UZOjaWiKK50ZSm_aTcBGQt2voctBbqBCl7RySgezBXjv63C7Mur4W2eNaIl-FUtAGNe1-rYeQUhHeTIECXkr9ed26c7bpDFH4R-YuHYFfumIdLHqZz5cR34qX2VSKUCHtLFsiRBnkcqR38MIjkhUiObtpWRfUMxGrcp4A7DczIk5ZpCVRNlKVg0Wq72WxJQK2G1YlApr5rW2Ldcq9q9C7TP1-VWG_ZBlWtsI01UurbLnWtUyaGnD9D4exhR7_8BefBo_w" alt=""><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></details> <blockquote><p>If you are still confused about how it is guaranteed to publish, see DTM's <a href="https://en.dtm.pub/practice/msg.html" target="_blank" rel="noopener noreferrer">2-phase messages doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for more information.</p></blockquote> <h2 id="how-does-the-dtm-inbox-work"><a href="#how-does-the-dtm-inbox-work" class="header-anchor">#</a> How Does the DTM Inbox Work?</h2> <p>Unlike ABP's default implementation, the DTM inbox gets an event from MQ and handles it at once. After the handlers finish their work, the inbox inserts a barrier within the current DB transaction. Finally, it commits the transaction and returns ACK to MQ.</p> <p>All the incoming events have a unique MessageId. Events with the same MessageId only are handled once since we cannot insert a barrier with a duplicate gid (MessageId).</p> <p><a href="https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNp9UstuwjAQ_JWVz_ADUUtFAakI5YDaYy6beAmW4jW115QK8e91HgWh0vhke2dmZ0d7VpXTpDIV6DMSV7Q0WHu0BUM6YqQhWH7ksObSnfpPjOI42pJ8_86309nsislgSY05kgdkoCOxPJV-9mVkDwiRTeoCOYWANa11L3DltjooWGKgDFYnEyRxSvTeJLlOojYanm_8l0FgIE3vjbwOTHYCOxf5Qbv54XAzLHvqHfe4VLsz9IasUxpXVBpQQ8AjQbVHrin8NdPJL_pqB9U36Xuvg3iIVUWkaTSZNQfybTRteSye0XQe2HrcbuGsNdLNLR45YCXG8bh2T_l3moTOtxnMFxs1UZa8RaPTDp5bXKFSJ0uFytJV0w5jI4Uq-JKg8aBRaKWNOK-yHTaBJqrdx_dvrlQmPtIvaNjjAXX5AUn_9To" target="_blank" rel="noopener noreferrer"><img src="https://mermaid.ink/img/pako:eNp9UstuwjAQ_JWVz_ADUUtFAakI5YDaYy6beAmW4jW115QK8e91HgWh0vhke2dmZ0d7VpXTpDIV6DMSV7Q0WHu0BUM6YqQhWH7ksObSnfpPjOI42pJ8_86309nsislgSY05kgdkoCOxPJV-9mVkDwiRTeoCOYWANa11L3DltjooWGKgDFYnEyRxSvTeJLlOojYanm_8l0FgIE3vjbwOTHYCOxf5Qbv54XAzLHvqHfe4VLsz9IasUxpXVBpQQ8AjQbVHrin8NdPJL_pqB9U36Xuvg3iIVUWkaTSZNQfybTRteSye0XQe2HrcbuGsNdLNLR45YCXG8bh2T_l3moTOtxnMFxs1UZa8RaPTDp5bXKFSJ0uFytJV0w5jI4Uq-JKg8aBRaKWNOK-yHTaBJqrdx_dvrlQmPtIvaNjjAXX5AUn_9To" alt=""><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <details><summary>See the more detailed sequence diagram</summary> <p><a href="https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNqNlN1uwjAMhV8lyjW8QLUxMWAampiExmVv3MSUaGnCEocxId59aVMoaPysV218_PnETrrjwkrkGff4FdAIHCsoHVS5YfEhRRrZeDFjU1PYbVqEQNaEqkCXvmfz_mBw1GRsjFpt0DEwDDdo6KFwg29FKwYsGBWrsBl6DyVOZQIcc2sOEBTgMWOTrfIUcwpwTkVcgyiVZI9d_lPrSFOS-4M6rTfwFtg_N_ncUpc2GHmiPlqJ8tk8Y8PRW4riQXYHaCydQk_3Nlyvu-7QClN7ki7Gznb_CkbG1h9VsZuSedggEyswJfq_Zhr8KEUbqezQ515buA9CIEq8OYap8ejqOdThW7PoRtGmLEFplHcn8RJlCSjDWisBhDX60kxOfTmrdfQjPpsekQPjQZCy5m7BRadtKCgbzo1D8P7vU3Ch_Zftj2xVKbrs_Ro7pVydWndieY9X6CpQMl7sXa3LeaxUYc6z-CpxCUFTznOzj9KwlrHnE6nIOp4tQXvs8fqSf_wYwTNyAQ-i9ufQqva_CSldXw" target="_blank" rel="noopener noreferrer"><img src="https://mermaid.ink/img/pako:eNqNlN1uwjAMhV8lyjW8QLUxMWAampiExmVv3MSUaGnCEocxId59aVMoaPysV218_PnETrrjwkrkGff4FdAIHCsoHVS5YfEhRRrZeDFjU1PYbVqEQNaEqkCXvmfz_mBw1GRsjFpt0DEwDDdo6KFwg29FKwYsGBWrsBl6DyVOZQIcc2sOEBTgMWOTrfIUcwpwTkVcgyiVZI9d_lPrSFOS-4M6rTfwFtg_N_ncUpc2GHmiPlqJ8tk8Y8PRW4riQXYHaCydQk_3Nlyvu-7QClN7ki7Gznb_CkbG1h9VsZuSedggEyswJfq_Zhr8KEUbqezQ515buA9CIEq8OYap8ejqOdThW7PoRtGmLEFplHcn8RJlCSjDWisBhDX60kxOfTmrdfQjPpsekQPjQZCy5m7BRadtKCgbzo1D8P7vU3Ch_Zftj2xVKbrs_Ro7pVydWndieY9X6CpQMl7sXa3LeaxUYc6z-CpxCUFTznOzj9KwlrHnE6nIOp4tQXvs8fqSf_wYwTNyAQ-i9ufQqva_CSldXw" alt=""><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></details> <blockquote><p>As you may have noticed, the inbox has nothing to do with the DTM Server.ğŸ¤­</p></blockquote> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <ol><li><p>Ensure you are NOT using the <a href="https://github.com/EasyAbp/Abp.EventBus.CAP" target="_blank" rel="noopener noreferrer">CAP bus<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and have installed another <a href="https://docs.abp.io/en/abp/latest/Distributed-Event-Bus#providers" target="_blank" rel="noopener noreferrer">bus provider<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></li> <li><p>Install the following NuGet packages. (<a href="https://github.com/EasyAbp/EasyAbpGuide/blob/master/docs/How-To.md#add-nuget-packages" target="_blank" rel="noopener noreferrer">see how<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <ul><li>EasyAbp.Abp.EventBus.Boxes.Dtm.Grpc</li> <li>EasyAbp.Abp.EventBus.Boxes.Dtm.EntityFramework</li> <li>EasyAbp.Abp.EventBus.Boxes.Dtm.MongoDB</li></ul></li> <li><p>Add <code>DependsOn(typeof(AbpEventBusBoxesDtmXxxModule))</code> attribute to configure the module dependencies. (<a href="https://github.com/EasyAbp/EasyAbpGuide/blob/master/docs/How-To.md#add-module-dependencies" target="_blank" rel="noopener noreferrer">see how<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p></li> <li><p>Configure the boxes and gRPC.</p></li></ol> <div class="language-CSharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">ServiceConfigurationContext</span> context<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// See https://docs.abp.io/en/abp/latest/Distributed-Event-Bus#additional-configuration</span>
    <span class="token generic-method"><span class="token function">Configure</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AbpDistributedEventBusOptions<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        options<span class="token punctuation">.</span>Outboxes<span class="token punctuation">.</span><span class="token function">Configure</span><span class="token punctuation">(</span>config <span class="token operator">=&gt;</span>
        <span class="token punctuation">{</span>
            config<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">UseDbContextWithDtmOutbox</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyProjectDbContext<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        options<span class="token punctuation">.</span>Inboxes<span class="token punctuation">.</span><span class="token function">Configure</span><span class="token punctuation">(</span>config <span class="token operator">=&gt;</span>
        <span class="token punctuation">{</span>
            config<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">UseDbContextWithDtmInbox</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MyProjectDbContext<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Use `AddDtmOutbox` and `AddDtmInbox` separately if you only need one of them.</span>
    context<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token function">AddDtmBoxes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    context<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token function">AddGrpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token function">AddAbpDtmGrpc</span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        options<span class="token punctuation">.</span>ActionApiToken <span class="token operator">=</span> <span class="token string">&quot;1q2w3e&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// DTM Server invokes app's action APIs with this token for authorization.</span>
        options<span class="token punctuation">.</span>AppGrpcUrl <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:54358&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// Base URL for DTM Server to invoke the current app. Only HTTP now!</span>
        options<span class="token punctuation">.</span>DtmGrpcUrl <span class="token operator">=</span> <span class="token string">&quot;http://127.0.0.1:36790&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// Base URL for the current app to invoke DTM Server.</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnApplicationInitialization</span><span class="token punctuation">(</span><span class="token class-name">ApplicationInitializationContext</span> context<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">UseConfiguredEndpoints</span><span class="token punctuation">(</span>endpoints <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        endpoints<span class="token punctuation">.</span><span class="token function">MapAbpDtmGrpcService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h2> <ol><li><p>Install and run the DTM Server. See https://en.dtm.pub/guide/install.html.</p></li> <li><p>Ensure the intranet endpoint (you configured above) is available since the DTM Server uses it to invoke your app.</p></li> <li><p>The DTM event boxes should work now.</p></li></ol> <h2 id="roadmap"><a href="#roadmap" class="header-anchor">#</a> Roadmap</h2> <ul><li>[ ] Barrier tables/collections auto clean up.</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/2/2022, 1:21:29 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/modules/Abp.SettingUi/" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
          Abp.SettingUi
        </a></span> <span class="next"><a href="/modules/Abp.EventBus.CAP/">
          Abp.EventBus.CAP
          <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> <div class="page-anchor"><div class="ant-space ant-space-vertical" style="width:100%;"><div class="ant-space-item"><div class="page-anchor-offset"><div><div class="ant-anchor-wrapper" style="max-height:100vh;"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a href="#introduction" title="Introduction" class="ant-anchor-link-title">Introduction</a></div><div class="ant-anchor-link"><a href="#differences-from-the-abp-s-default-event-boxes" title="Differences From the ABP's Default Event Boxes" class="ant-anchor-link-title">Differences From the ABP's Default Event Boxes</a></div><div class="ant-anchor-link"><a href="#how-does-the-dtm-outbox-work" title="How Does the DTM Outbox Work?" class="ant-anchor-link-title">How Does the DTM Outbox Work?</a></div><div class="ant-anchor-link"><a href="#how-does-the-dtm-inbox-work" title="How Does the DTM Inbox Work?" class="ant-anchor-link-title">How Does the DTM Inbox Work?</a></div><div class="ant-anchor-link"><a href="#installation" title="Installation" class="ant-anchor-link-title">Installation</a></div><div class="ant-anchor-link"><a href="#usage" title="Usage" class="ant-anchor-link-title">Usage</a></div><div class="ant-anchor-link"><a href="#roadmap" title="Roadmap" class="ant-anchor-link-title">Roadmap</a></div></div></div></div></div></div></div></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d08d4d6d.js" defer></script><script src="/assets/js/2.96af7ef6.js" defer></script><script src="/assets/js/34.9b2c128d.js" defer></script>
  </body>
</html>